language: generic
dist: xenial
sudo: false
services:
  - docker
env:
  global:
    - DOCKER_HOST_REGISTRY: repo.treescale.com
    - DOCKER_HOST_REGISTRY_USER: dchacko
    - APPLICATION_ID: clientpanel
    - secure: vxd1ygbZOHZa+IsqysSqRrNE9Z6XH36pTd/2VarkeV2LUJDSx5lh6Wzh/FAI3trfqw6UhZDrrWLCvGJmZikoXPm6EEQsWeYXKr2bpjBCk3ob+tRLDePnd7CU1SP9XJTphjnc4rDQQxTP2Fx3x63007frBD6jMi9yRX027gokGXOhRPqt31WGHWghwEQruZeuwFq4tyVk3KEWNwLTeNgJcgJvHssn7gD4jz6W3fFAHAOSy+xJiVqd+aMyRJEzr9u5ubz/Ybe/r/5QGUAjSM8dvc91hVoH2tVz6BbWsN8T4pbEOeXuRwLdlZteG//X4jFQIfHY/frsmcehhoGRkSjJSm55Y33rTkKEfpLgWdxFiko+oya6PxiGdq6FXhsCUCDTdB76E+D3uliqEbicc+YLPVoShSe5qaAATStE2898zDXWyd99NAr+IIiYD2CFK90T9W6FGT4yjrjCBfe2KmcWMP+gcJdctFk6tgRIw/jjZFDqAwM6T+oW6fPRYZiUCmdN5M1/2/AKzQMe4ZbKoK54YgcZ7MKO05+CQsHTt0FalO7fdJ2ovJgRZc5y7psxlZ/eXOJBqwKsIvN8AHSDuiDsrNUcz2XiYv4jO0L4fjWK7MdctsbuFurN5V4Q7pY9RcRZR6k03E0GEGEfVymf65JtTFKHM82jzH9VgXrfWNNifnE=
    - secure: MfjTzGZz/EVJZ/TfXG/BGlH/d+/cnB7cib/RccSuanJhKYDbNHVTYe9Ge+JJy9fteeGJZohvKEDe4u0Iuk1VPO9abrNZkiKyE4pmgZbSPYp7A7wqrO4K/7PAWrb6JSrlkL8DTWmjKmQSlu2l8v5/AQHFjUhhd0Yl0r/q2FcAhPQxLsUA8hqMKwE+GeRSC3UZV04lZDFO393J1gte0n910fJqjiH7+HSSpSbgsfqMyeNFsEEI2HindSkiUnueS4qZQtbExom5Kd7rrXX8f/hREPxV/dU88/WoYAKZ94WbbNSgrS08YK2mUFtk+EAua5SW6CSkAlmRi8XR21D/Y+1HUqUxyOhCLRSQ2nQV3pz2XPXMcIJjeJWSFnPHK9Ko697aSHYGu7oRheLvaQPNwgeKMcCqwFwuwWL59I8GTTWDEPT9SXnkUz+98qFBPQ6PEm3o7P2tFtqEnVm7OWbJsGD0LBvh5zC3MpThlll9CV/l//XSCzzMV9a4n7nS1AQG0BmNFtwNP+Vsa8sJyzm4xcKafcKcJMsKYH/gAJF4WnqhNv7yNH1q6RBfHt6N2BCIlVwPg3tWTavlgxAMRckJHyKbJDvnKcUJPCV6jVQn24yh8ERk77nlCBfvYSW5nSFwwRNH32bxhsPF7hP0ChLXE2BiEWEv7/pIJ+ulRQDrXNmjP10=

    #- secure: YiNBElhi3kJR2OEQmsNfFf7ecBMhdmuCMS+w7qXb6eZ+YRKCfyhSEjPXkcPqhoo+D7xHJA5BLvTFy79uxBhhb/ZXdysxU38p8dTOtHWBjfJ9/Ku/77qefDVG0fHmPgXk+PCb9XXorrU4VC+VB+jT0EGI4xvv7Pe/ux7I+eC6EIbiWNcULQtepHUDq4oS1bJnr02K1c9rhNqPTujWfw43Q7X0PnDgRXAoYw6zkSV0RL8JVHu/kul5DVsKIQTN4jFRJv0YqesN6QpJJRp867rIL9d42hVXPW49mZWzHnWTePdikaJdZFlyFLXNze746tVJhoywYxUslLWBinPSX7dOxtlfJXXhQvAdWFdeiTtKubfz+04ZIuioKiiVCZD6UV1r1Gxx9H6gy9dTygpDmC4NEF+fRx4+JgMQ+VzFdksVIkULjzg8KVItt1s8IiOoQFS57+CB/qWdcaej253LCuPLKS9T68fIE1EW37ECToA9+udnxJ1WxRW3/LtcCFgbv3F6PpBeQU3Fc1+G3hnYZ9cniteEhKZHN4ELBirt75WU+GkiEWs4X3DVgxS4f18ARVpX8PemeXV7md4J+ney2o3L2wPMTE4X60lRpq9lfdNK/f/Z7ac36EunB9tdHoEFXdYXz+Z8FQKdI+82wGZTA1cCGd0bEGpWcNWpLjgXTSDu0tY=
    #- secure: tFmVM5X0GhPNu0oVc3EkLqqdY+WRSaOkg3lOdEiuBRsgaUpt6mwxkVXZaYos4PVzfyZQAbvyF0UzmBsdloLQcsk5GazCt7EfmCx/h7kc1IAJm36WgLBIzuWiG4d059+V+O9eCfrsfNu9s87fzNaxkQjtDssBbLBLTq8vHzZl/kFW8FMNB7UWUEfZwzsfl6YwgihmDA66Mp2rVgBjO0T3OVIbmW8QM7mDe5dgjFg9Vl2MjSQTb8IcyomdGCvN4hvpyK19Ga7f4qcTJfIpuHPhKOk+OBcM3VtNL8DO4FSljRFelz4VM5gRSyYEW40L8UoFyezpsMzxL6eLBF4C96KwlOwpCltbjBqUl3U9pHm+IXn/W2Te7m4pqguFToaAZR3q/2NRtMLwYgo5no5fD5llHawNDbfIbusaNtOR297g08VYjAo8r8b1+7SRX1idPPG46K9B3rNi+SHVZv/cL2GmDgoI6quZ1Kyb+cEdPvwo1+G9RIPcIV1NErhdY2aT2rhJ5uTLrBZfS/IuCamYRL/Cn+KI/pSed945tvQfeK2SUsamo6CRRcx53EH33k0M2TAv+ciJDo+4mvegJyhz2+g50l7FoJ4E+h7RPtuhHAt8pMAxrF0Ocm+rgBk43GA5u/rgkmEo9O/+e+xai2YScyvY0IgqpRf4gP9VgFT2sdThJGc=

script:
  - pip install --user awscli # install aws cli w/o sudo
  - export PATH=$PATH:$HOME/.local/bin # put aws in the path
  - docker login -u $TREESCALE_USER -p $TREESCALE_PASS $DOCKER_HOST_REGISTRY
  - docker build -t $APPLICATION_ID:latest -t $DOCKER_HOST_REGISTRY/$DOCKER_HOST_REGISTRY_USER/$APPLICATION_ID:$TRAVIS_BRANCH-SNAPSHOT-$TRAVIS_BUILD_NUMBER .
  - docker push $DOCKER_HOST_REGISTRY/$DOCKER_HOST_REGISTRY_USER/$APPLICATION_ID:$TRAVIS_BRANCH-SNAPSHOT-$TRAVIS_BUILD_NUMBER
  - docker logout $DOCKER_HOST_REGISTRY
